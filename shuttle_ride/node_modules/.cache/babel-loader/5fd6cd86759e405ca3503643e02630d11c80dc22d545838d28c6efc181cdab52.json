{"ast":null,"code":"export const loginUser = async (mobileNumber, Role) => {\n  try {\n    const response = await fetch('http://localhost:5001/auth/send_otp', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        mobileNumber: mobileNumber,\n        // ensure this is a string\n        role: Role // ensure this is an integer\n      })\n    });\n    if (response.ok) {\n      const data = await response.text();\n      return data === \"pending\" ? \"pending\" : data;\n    } else {\n      console.log(`Request failed with status: ${response.status}`);\n      return \"error\";\n    }\n  } catch (error) {\n    console.error(\"Error:\", error);\n    throw error;\n  }\n};\nexport const Login_OTP = async (mobileNumber, otp) => {\n  try {\n    const response = await fetch(\"http://localhost:5001/auth/verify_otp\", {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Access-Control-Allow-Origin': '*'\n      },\n      body: JSON.stringify({\n        mobileNumber: mobileNumber,\n        // ensure this is a string\n        otp: otp // ensure this is an integer\n      })\n    });\n    if (response.ok) {\n      const data = await response.text();\n      if (data === \"-1\") {\n        return false;\n      } else {\n        localStorage.setItem(\"JWT\", data);\n        return true;\n      }\n    } else {\n      console.log(\"Request failed with status:\", response.status);\n      return \"error\";\n    }\n  } catch (error) {\n    console.error(\"Error:\", error);\n    throw error;\n  }\n};\n_c = Login_OTP;\nexport const getUserBookings = async () => {\n  const token = localStorage.getItem('JWT');\n  const response = await fetch(\"http://localhost:5001/users/bookings\", {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      jwt: token\n    })\n  });\n  if (!response.ok) {\n    throw new Error(`Error: ${response.status} - ${response.statusText}`);\n  }\n  const text = await response.text(); // Get the raw response text\n  const parser = new DOMParser();\n  const xmlDoc = parser.parseFromString(text, \"text/xml\");\n  const items = xmlDoc.getElementsByTagName(\"item\");\n  const bookings = Array.from(items).map(item => ({\n    bookingId: item.getElementsByTagName(\"bookingId\")[0].textContent,\n    seatNumber: item.getElementsByTagName(\"seatNumber\")[0].textContent,\n    bookingTime: item.getElementsByTagName(\"bookingTime\")[0].textContent,\n    travelDate: item.getElementsByTagName(\"travelDate\")[0].textContent,\n    status: item.getElementsByTagName(\"status\")[0].textContent\n    // source: {\n    //     first: item.getElementsByTagName(\"source\")[0].getElementsByTagName(\"first\")[0].textContent,\n    //     second: item.getElementsByTagName(\"source\")[0].getElementsByTagName(\"second\")[0].textContent,\n    // },\n    // destination: {\n    //     first: item.getElementsByTagName(\"destination\")[0].getElementsByTagName(\"first\")[0].textContent,\n    //     second: item.getElementsByTagName(\"destination\")[0].getElementsByTagName(\"second\")[0].textContent,\n    // },\n    // bus: {\n    //     busId: item.getElementsByTagName(\"busId\")[0].textContent, // Assuming you also want the bus ID\n    // }\n  }));\n  return bookings;\n};\nexport const cancelBooking = async bookingId => {\n  const token = localStorage.getItem('JWT');\n  console.log(bookingId);\n  const response = await fetch(\"http://localhost:5001/users/cancel-booking\", {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    body: JSON.stringify({\n      BookingID: bookingId,\n      jwt: token\n    })\n  });\n  return response;\n};\nexport const search_busses = async (s1, s2, d1, d2) => {\n  const token = localStorage.getItem('JWT');\n  const response = await fetch(\"http://localhost:5001/users/search\", {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${token}` // Include token if required\n    },\n    body: JSON.stringify({\n      s1: s1,\n      s2: s2,\n      d1: d1,\n      d2: d2\n    })\n  });\n  const text = await response.text(); // Get the raw response text\n  console.log(\"Raw response text:\", text); // Log the raw response\n\n  const parser = new DOMParser();\n  const xmlDoc = parser.parseFromString(text, \"text/xml\");\n  const items = xmlDoc.getElementsByTagName(\"item\");\n  const buses = Array.from(items).map(item => {\n    var _item$getElementsByTa, _item$getElementsByTa2, _item$getElementsByTa3, _item$getElementsByTa4, _item$getElementsByTa5;\n    return {\n      busId: ((_item$getElementsByTa = item.getElementsByTagName(\"busId\")[0]) === null || _item$getElementsByTa === void 0 ? void 0 : _item$getElementsByTa.textContent) || 'N/A',\n      busName: ((_item$getElementsByTa2 = item.getElementsByTagName(\"busName\")[0]) === null || _item$getElementsByTa2 === void 0 ? void 0 : _item$getElementsByTa2.textContent) || 'N/A',\n      totalSeats: ((_item$getElementsByTa3 = item.getElementsByTagName(\"totalSeats\")[0]) === null || _item$getElementsByTa3 === void 0 ? void 0 : _item$getElementsByTa3.textContent) || 'N/A',\n      currentOccupancy: ((_item$getElementsByTa4 = item.getElementsByTagName(\"currentOccupancy\")[0]) === null || _item$getElementsByTa4 === void 0 ? void 0 : _item$getElementsByTa4.textContent) || 'N/A',\n      live: ((_item$getElementsByTa5 = item.getElementsByTagName(\"live\")[0]) === null || _item$getElementsByTa5 === void 0 ? void 0 : _item$getElementsByTa5.textContent) === \"true\"\n      // seatPlan: Array.from(item.getElementsByTagName(\"seatPlan\")[0]?.children || []).map(seat => ({\n      //     seatNumber: seat.tagName,\n      //     isAvailable: seat.textContent === \"true\"\n      // }))\n    };\n  });\n  console.log(\"Buses array:\", buses);\n  return buses;\n};\nvar _c;\n$RefreshReg$(_c, \"Login_OTP\");","map":{"version":3,"names":["loginUser","mobileNumber","Role","response","fetch","method","headers","body","JSON","stringify","role","ok","data","text","console","log","status","error","Login_OTP","otp","localStorage","setItem","_c","getUserBookings","token","getItem","jwt","Error","statusText","parser","DOMParser","xmlDoc","parseFromString","items","getElementsByTagName","bookings","Array","from","map","item","bookingId","textContent","seatNumber","bookingTime","travelDate","cancelBooking","BookingID","search_busses","s1","s2","d1","d2","buses","_item$getElementsByTa","_item$getElementsByTa2","_item$getElementsByTa3","_item$getElementsByTa4","_item$getElementsByTa5","busId","busName","totalSeats","currentOccupancy","live","$RefreshReg$"],"sources":["/Users/vivek/Desktop/movein/shuttle_ride/src/apicalls/user.js"],"sourcesContent":["export const loginUser = async (mobileNumber, Role) => {\n    try {\n        const response = await fetch('http://localhost:5001/auth/send_otp', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                mobileNumber: mobileNumber, // ensure this is a string\n                role: Role                   // ensure this is an integer\n            })\n        });\n\n        if (response.ok) {\n            const data = await response.text();\n            return data === \"pending\" ? \"pending\" : data;\n        } else {\n            console.log(`Request failed with status: ${response.status}`);\n            return \"error\";\n        }\n    } catch (error) {\n        console.error(\"Error:\", error);\n        throw error;\n    }\n};\n\nexport const Login_OTP = async (mobileNumber, otp) => {\n    try {\n        const response = await fetch(\"http://localhost:5001/auth/verify_otp\", {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Access-Control-Allow-Origin': '*'\n            },\n            body: JSON.stringify({\n                mobileNumber: mobileNumber, // ensure this is a string\n                otp: otp                   // ensure this is an integer\n            })\n        });\n        if (response.ok) {\n            const data = await response.text();\n            if (data === \"-1\") {\n                return false;\n            } else {\n                localStorage.setItem(\"JWT\", data);\n                return true;\n            }\n        }else {\n            console.log(\"Request failed with status:\", response.status);\n            return \"error\";\n        }\n    } catch (error) {\n        console.error(\"Error:\", error);\n        throw error;\n    }\n\n}\nexport const getUserBookings = async () => {\n    const token = localStorage.getItem('JWT');\n    const response = await fetch(\"http://localhost:5001/users/bookings\", {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n            jwt: token\n        })\n    });\n\n    if (!response.ok) {\n        throw new Error(`Error: ${response.status} - ${response.statusText}`);\n    }\n\n    const text = await response.text(); // Get the raw response text\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(text, \"text/xml\");\n    const items = xmlDoc.getElementsByTagName(\"item\");\n    const bookings = Array.from(items).map(item => ({\n        bookingId: item.getElementsByTagName(\"bookingId\")[0].textContent,\n        seatNumber: item.getElementsByTagName(\"seatNumber\")[0].textContent,\n        bookingTime: item.getElementsByTagName(\"bookingTime\")[0].textContent,\n        travelDate: item.getElementsByTagName(\"travelDate\")[0].textContent,\n        status: item.getElementsByTagName(\"status\")[0].textContent,\n        // source: {\n        //     first: item.getElementsByTagName(\"source\")[0].getElementsByTagName(\"first\")[0].textContent,\n        //     second: item.getElementsByTagName(\"source\")[0].getElementsByTagName(\"second\")[0].textContent,\n        // },\n        // destination: {\n        //     first: item.getElementsByTagName(\"destination\")[0].getElementsByTagName(\"first\")[0].textContent,\n        //     second: item.getElementsByTagName(\"destination\")[0].getElementsByTagName(\"second\")[0].textContent,\n        // },\n        // bus: {\n        //     busId: item.getElementsByTagName(\"busId\")[0].textContent, // Assuming you also want the bus ID\n        // }\n    }));\n    return bookings; \n};\n\nexport const cancelBooking = async (bookingId) => {\n    const token = localStorage.getItem('JWT');\n    console.log(bookingId);\n    const response = await fetch(\"http://localhost:5001/users/cancel-booking\", {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n            BookingID:bookingId,\n            jwt:token\n           })\n    });\n    return response;\n};\nexport const search_busses = async (s1, s2, d1, d2) => {\n    const token = localStorage.getItem('JWT');\n    const response = await fetch(\"http://localhost:5001/users/search\", {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`, // Include token if required\n        },\n        body: JSON.stringify({\n            s1: s1,\n            s2: s2,\n            d1: d1,\n            d2: d2\n        })\n    });\n\n    const text = await response.text(); // Get the raw response text\n    console.log(\"Raw response text:\", text); // Log the raw response\n\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(text, \"text/xml\");\n\n    const items = xmlDoc.getElementsByTagName(\"item\");\n    const buses = Array.from(items).map(item => ({\n        busId: item.getElementsByTagName(\"busId\")[0]?.textContent || 'N/A',\n        busName: item.getElementsByTagName(\"busName\")[0]?.textContent || 'N/A',\n        totalSeats: item.getElementsByTagName(\"totalSeats\")[0]?.textContent || 'N/A',\n        currentOccupancy: item.getElementsByTagName(\"currentOccupancy\")[0]?.textContent || 'N/A',\n        live: item.getElementsByTagName(\"live\")[0]?.textContent === \"true\",\n        // seatPlan: Array.from(item.getElementsByTagName(\"seatPlan\")[0]?.children || []).map(seat => ({\n        //     seatNumber: seat.tagName,\n        //     isAvailable: seat.textContent === \"true\"\n        // }))\n    }));\n\n    console.log(\"Buses array:\", buses); \n    return buses; \n};\n\n    "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}